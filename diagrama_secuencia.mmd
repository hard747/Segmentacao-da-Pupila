sequenceDiagram
    participant U as Usuário
    participant CS as ControladorSincronizacao
    participant GD as GerenciadorDispositivos
    participant DF as DetectorFaixa
    participant CP3E as Câmera PS3 Eye
    participant A as Arduino

    activate U
    U->>CS: iniciar programa
    deactivate U

    activate CS
    CS->>GD: iniciar_camera_e_serial()
    activate GD
    GD->>CP3E: abrir()
    GD->>A: iniciar_serial()
    CP3E-->>GD: ok
    A-->>GD: ok
    GD-->>CS: ok
    deactivate GD
    
    loop Loop Principal (Processamento de Frames)
        activate CS
        CS->>GD: capturar_frame()
        activate GD
        GD->>CP3E: read()
        CP3E-->>GD: frame
        GD-->>CS: frame
        deactivate GD
        
        CS->>DF: detectar_faixa_iluminacao(frame)
        activate DF
        DF-->>CS: resultado_detecção
        deactivate DF
        
        alt Se for necessário ajustar período
            CS->>GD: enviar_comando("M...")
            activate GD
            GD->>A: enviar_comando_serial()
            A-->>GD: ok
            deactivate GD
        end
        
        CS->>CS: processar_estado()
    end
    
    activate U
    U->>CS: "q"
    deactivate U
    
    CS->>GD: liberar()
    activate GD
    GD->>CP3E: liberar()
    GD->>A: fechar_serial()
    deactivate GD
    deactivate CS